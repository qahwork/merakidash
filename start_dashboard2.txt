# Meraki Network Analytics Dashboard Pro - PowerShell Launcher
# Enhanced Network Performance & Analytics Platform

param(
    [string]$Port = "8501"
)

# UTF-8 ì¸ì½”ë”© ì„¤ì •
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8

Write-Host ""
Write-Host "========================================" -ForegroundColor Cyan
Write-Host "ğŸš€ Meraki Network Analytics Dashboard Pro" -ForegroundColor Green
Write-Host "========================================" -ForegroundColor Cyan
Write-Host ""

# Python ì„¤ì¹˜ í™•ì¸
try {
    $pythonVersion = python --version 2>&1
    Write-Host "âœ… Python ì„¤ì¹˜ í™•ì¸ë¨: $pythonVersion" -ForegroundColor Green
} catch {
    Write-Host "âŒ Pythonì´ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." -ForegroundColor Red
    Write-Host ""
    Write-Host "ğŸ’¡ Pythonì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”:" -ForegroundColor Yellow
    Write-Host "   1. https://www.python.org/downloads/ ë°©ë¬¸" -ForegroundColor White
    Write-Host "   2. Python 3.8+ ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜" -ForegroundColor White
    Write-Host "   3. 'Add Python to PATH' ì²´í¬ë°•ìŠ¤ ì„ íƒ" -ForegroundColor White
    Write-Host ""
    Read-Host "ê³„ì†í•˜ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”"
    exit 1
}

# ê°€ìƒí™˜ê²½ í™•ì¸ ë° ìƒì„±
if (-not (Test-Path "venv")) {
    Write-Host ""
    Write-Host "ğŸ”§ ê°€ìƒí™˜ê²½ ìƒì„± ì¤‘..." -ForegroundColor Yellow
    python -m venv venv
    Write-Host "âœ… ê°€ìƒí™˜ê²½ ìƒì„± ì™„ë£Œ" -ForegroundColor Green
}

# ê°€ìƒí™˜ê²½ í™œì„±í™”
Write-Host ""
Write-Host "ğŸ”„ ê°€ìƒí™˜ê²½ í™œì„±í™” ì¤‘..." -ForegroundColor Yellow
& "venv\Scripts\Activate.ps1"

# ì˜ì¡´ì„± ì„¤ì¹˜ í™•ì¸
if (-not (Test-Path "venv\Lib\site-packages\streamlit")) {
    Write-Host ""
    Write-Host "ğŸ“¦ í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì¤‘..." -ForegroundColor Yellow
    pip install -r requirements.txt
    Write-Host "âœ… íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ" -ForegroundColor Green
} else {
    Write-Host "âœ… í•„ìš”í•œ íŒ¨í‚¤ì§€ê°€ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤" -ForegroundColor Green
}

# ëŒ€ì‹œë³´ë“œ ì‹¤í–‰
Write-Host ""
Write-Host "ğŸš€ Meraki Dashboard ì‹œì‘ ì¤‘..." -ForegroundColor Green
Write-Host "ğŸ“± ì›¹ ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤" -ForegroundColor White
Write-Host "ğŸ” ì‚¬ì´ë“œë°”ì—ì„œ Meraki API í‚¤ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ Demo ëª¨ë“œë¥¼ í™œì„±í™”í•˜ì„¸ìš”" -ForegroundColor White
Write-Host ""
Write-Host "========================================" -ForegroundColor Cyan
Write-Host ""

try {
    # Streamlit ì‹¤í–‰
    streamlit run meraki_dashboard_complete_final.py --server.port $Port
} catch {
    Write-Host ""
    Write-Host "âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤." -ForegroundColor Red
    Write-Host "ğŸ’¡ ë‹¤ìŒì„ í™•ì¸í•´ì£¼ì„¸ìš”:" -ForegroundColor Yellow
    Write-Host "   1. Pythonì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€" -ForegroundColor White
    Write-Host "   2. ì¸í„°ë„· ì—°ê²° ìƒíƒœ" -ForegroundColor White
    Write-Host "   3. ë°©í™”ë²½ ì„¤ì •" -ForegroundColor White
    Write-Host ""
    Read-Host "ê³„ì†í•˜ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”"
}

Write-Host ""
Read-Host "ì¢…ë£Œí•˜ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”"
